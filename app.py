import streamlit as st
from docx import Document
from docx.shared import Pt
from docx.enum.text import WD_ALIGN_PARAGRAPH
import io

# --- SAHIFANI SOZLASH ---
st.set_page_config(page_title="Rasmiy Shartnoma Generator", layout="wide", page_icon="üìÑ")

# --- LOGIN TIZIMI ---
if 'logged_in' not in st.session_state:
    st.session_state['logged_in'] = False

if not st.session_state['logged_in']:
    st.title("üîê Tizimga kirish")
    u = st.text_input("Login:")
    p = st.text_input("Parol:", type="password")
    if st.button("Kirish"):
        if u == "admin" and p == "12345":
            st.session_state['logged_in'] = True
            st.rerun()
        else: st.error("Login yoki parol xato!")
    st.stop()

# --- WORD GENERATOR (100% ASIL MATN) ---
def create_official_docx(d):
    doc = Document()
    style = doc.styles['Normal']
    style.font.name = 'Times New Roman'
    style.font.size = Pt(11)

    def add_p(text, bold=False, align="justify", size=11):
        p = doc.add_paragraph()
        p.alignment = WD_ALIGN_PARAGRAPH.JUSTIFY if align=="justify" else WD_ALIGN_PARAGRAPH.CENTER
        run = p.add_run(text)
        run.bold = bold
        run.font.size = Pt(size)
        return p

    # --- 1-SAHIFA ---
    add_p("–ú–∞—Ö—Å—É–ª–æ—Ç “õ–∏–π–º–∞—Ç–∏–Ω–∏ –±—û–ª–∏–± —Ç—û–ª–∞—à —à–∞—Ä—Ç–∏ –±–∏–ª–∞–Ω —Ç—É–∑–∏–ª–≥–∞–Ω", True, "center", 12)
    add_p(f"‚Ññ {d['nomer']}- —Å–æ–Ω–ª–∏ –æ–ª–¥–∏ —Å–æ—Ç–¥–∏", True, "center", 12)
    add_p("–®–ê–†–¢–ù–û–ú–ê", True, "center", 14)
    add_p(f"{d['sana']}", True, "center")

    intro = doc.add_paragraph()
    intro.alignment = WD_ALIGN_PARAGRAPH.JUSTIFY
    intro.add_run(f"           –ú–µ–Ω  {d['ism']}     –£–∑–±–µ–∫–∏—Å—Ç–æ–Ω  –§—É–∫–∞—Ä–æ—Å–∏,  –ø–∞—Å–ø–æ—Ä—Ç ‚Ññ {d['pasport']} {d['pas_sana']}  {d['pas_joy']}   —Ç–æ–º–æ–Ω–∏–¥–∞–Ω –±–µ—Ä–∏–ª–≥–∞–Ω   {d['manzil']} –∏—Å—Ç–∏“õ–æ–º–∞—Ç “õ–∏–ª—É–≤—á–∏, —Ç–µ–ª–µ—Ñ–æ–Ω   {d['tel']}‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù –±–∏—Ä —Ç–∞—Ä–∞—Ñ–¥–∞–Ω –≤–∞ OOO \"NEW DREAMS STAR\" –Ω–æ–º–∏–¥–∞–Ω –£—Å—Ç–∞–≤ –∞—Å–æ—Å–∏–¥–∞ —Ñ–∞–æ–ª–∏—è—Ç —é—Ä–∏—Ç—É–≤—á–∏ –≤–∞ –∫–µ–π–∏–Ω–≥–∏ —û—Ä–∏–Ω–ª–∞—Ä–¥–∞ ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù –¥–µ–± –Ω–æ–º–ª–∞–Ω—É–≤—á–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä –ù—É—Ä–±–µ–∫–æ–≤ –£.–Æ. –∏–∫–∫–∏–Ω—á–∏ —Ç–∞—Ä–∞—Ñ–¥–∞–Ω —É—à–±—É —à–∞—Ä—Ç–Ω–æ–º–∞–Ω–∏ “õ—É–π–∏–¥–∞–≥–∏–ª–∞—Ä “≥–∞“õ–∏–¥–∞ —Ç—É–∑–¥–∏–∫: ").font.size = Pt(11)

    add_p("1. –®–∞—Ä—Ç–Ω–æ–º–∞ –ø—Ä–µ–¥–º–µ—Ç–∏", True, "center")
    add_p("1.1. –£—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–≥–∞ –∞—Å–æ—Å–∞–Ω ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù —Ç–æ–≤–∞—Ä–ª–∞—Ä–Ω–∏ ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù–Ω–∏–Ω–≥ —ç–≥–∞–ª–∏–≥–∏–≥–∞ —Ç–æ–ø—à–∏—Ä–∏—à, ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù —ç—Å–∞ —É—à–±—É —Ç–æ–≤–∞—Ä–ª–∞—Ä–Ω–∏ “õ–∞–±—É–ª “õ–∏–ª–∏–± –æ–ª–∏—à –≤–∞ —É–ª–∞—Ä —É—á—É–Ω –±–µ–ª–≥–∏–ª–∞–Ω–≥–∞–Ω “õ–∏–π–º–∞—Ç–Ω–∏ –±—û–ª–∏–± —Ç—û–ª–∞—à –º–∞–∂–±—É—Ä–∏—è—Ç–∏–Ω–∏ —û–∑ –∑–∏–º–º–∞–ª–∞—Ä–∏–≥–∞ –æ–ª–∞–¥–∏–ª–∞—Ä.")
    add_p("1.2. –¢–æ–≤–∞—Ä–ª–∞—Ä —Ö–∞—Ä–∏–¥–æ—Ä–≥–∞ —Ç—û–ª–∏–∫ —Ç–æ–ø—à–∏—Ä–∏–ª–≥–∞–Ω –≤–∞“õ—Ç–¥–∞–Ω –±–æ—à–ª–∞–±, —É–Ω–∏–Ω–≥ “õ–∏–π–º–∞—Ç–∏ —Ç—û–ª–∏“õ —Ç—û–ª–∞–Ω–∏—à–∏–≥–∞ “õ–∞–¥–∞—Ä, —Å–æ—Ç–∏–ª–≥–∞–Ω —Ç–æ–≤–∞—Ä–ª–∞—Ä xa—Ä–∏–¥–æ—Ä–Ω–∏–Ω–≥ “õ–∞—Ä–∑–∏–Ω–∏ —Ç—û–ª–∞—à –º–∞–∂–±—É—Ä–∏—è—Ç–∏–Ω–∏ –±–∞–∂–∞—Ä–∏—à–∏–Ω–∏ —Ç–∞—ä–º–∏–Ω–ª–∞—à —É—á—É–Ω —Å–æ—Ç—É–≤—á–∏ —Ç–æ–º–æ–Ω–∏–¥–∞–Ω –≥–∞—Ä–æ–≤–≥–∞ –æ–ª–∏–Ω–≥–∞–Ω –¥–µ–± —Ç–∞–Ω –æ–ª–∏–Ω–∞–¥–∏.")
    
    add_p("2. –®–∞—Ä—Ç–Ω–æ–º–∞ —Å—É–º–º–∞—Å–∏ –≤–∞ “≥–∏—Å–æ–±-–∫–∏—Ç–æ–±–ª–∞—Ä —Ç–∞—Ä—Ç–∏–±–∏", True, "center")
    add_p("2.1. –£—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–Ω–∏–Ω–≥ —Å—É–º–º–∞—Å–∏ 1-–∏–ª–æ–≤–∞–¥–∞.\n2.2. –¢–æ–≤–∞—Ä ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù–≥–∞ –º—É–¥–¥–∞—Ç–ª–∏ —Ç—û–ª–æ–≤ —à–∞—Ä—Ç–ª–∞—Ä–∏–¥–∞, —É—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–¥–∞ –∫—û–∑–¥–∞ —Ç—É—Ç–∏–ª–≥–∞–Ω —Ç–∞—Ä—Ç–∏–±–¥–∞ —Ç–æ–ø—à–∏—Ä–∏–ª–∞–¥–∏.\n2.3. –¢–æ–≤–∞—Ä ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù–Ω–∏–Ω–≥ —ç–≥–∞–ª–∏–∫ “≥—É“õ—É“õ–∏ –∞—Å–æ—Å–∏–¥–∞ —Ç–µ–≥–∏—à–ª–∏ –±—û–ª–∏–±, —É—á–∏–Ω—á–∏ —à–∞—Ö—Å–ª–∞—Ä–Ω–∏–Ω–≥ “≥–∞—Ä “õ–∞–Ω–¥–∞–π “≥—É“õ—É“õ–ª–∞—Ä–∏–¥–∞–Ω –æ–∑–æ–¥ —ç—Ç–∏–ª–≥–∞–Ω, –≥–∞—Ä–æ–≤ –±–∏–ª–∞–Ω —é–∫–ª–∞–Ω–º–∞–≥–∞–Ω, —Ç–∞“õ–∏“õ —Å–æ–ª–∏–Ω–º–∞–≥–∞–Ω.\n2.4. –°—û—Ä–æ–≤–≥–∞ –∞—Å–æ—Å–∞–Ω —Ç–æ–≤–∞—Ä–ª–∞—Ä –µ—Ç–∫–∞–∑–∏–± –±–µ—Ä–∏–ª–≥–∞–Ω–¥–∞, ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù —Ç–æ–≤–∞—Ä–ª–∞—Ä–Ω–∏ “õ–∞–±—É–ª “õ–∏–ª–∏—à–¥–∞–Ω –∞—Å–æ—Å—Å–∏–∑ –±–æ—à —Ç–æ—Ä—Ç—Å–∞, —ë–∫–∏ “ö–∞–±—É–ª “õ–∏–ª–∏—à-—Ç–æ–ø—à–∏—Ä–∏—à –¥–∞–ª–æ–ª–∞—Ç–Ω–æ–º–∞—Å–∏–≥–∞ –∏–º–∑–æ “õ—û–π–∏—à–Ω–∏ —Ä–∞–¥ —ç—Ç—Å–∞, ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù –∞–≤–∞–Ω—Å —Ç—û–ª–æ–≤–∏–Ω–∏–Ω–≥ 50 % –º–∏“õ–¥–æ—Ä–∏–¥–∞, –ª–µ–∫–∏–Ω 50 000 (—ç–ª–ª–∏–∫ –º–∏–Ω–≥) —Å—û–º–¥–∞–Ω –∫–∞–º –±—û–ª–º–∞–≥–∞–Ω –º–∏“õ–¥–æ—Ä–¥–∞, —É—à–±—É —Ç–æ–≤–∞—Ä–Ω–∏ —Ä–∞—Å–º–∏–π–ª–∞—à—Ç–∏—Ä–∏—à –≤–∞ –µ—Ç–∫–∞–∑–∏–± –±–µ—Ä–∏—à —É—á—É–Ω “õ–∏–ª–∏–Ω–≥–∞–Ω “≥–∞—Ä–∞–∂–∞—Ç–ª–∞—Ä–Ω–∏ “õ–æ–ø–ª–∞—à —É—á—É–Ω –∂–∞—Ä–∏–º–∞ —Ç—û–ª–∞–π–¥–∏.\n2.5. –•–∞—Ä–∏–¥ “õ–∏–ª–∏–Ω–≥–∞–Ω —Ç–æ–≤–∞—Ä–ª–∞—Ä “õ–∏–π–º–∞—Ç–∏–Ω–∏–Ω–≥ “õ–æ–ª–≥–∞–Ω —Å—É–º–º–∞—Å–∏ ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù —Ç–æ–º–æ–Ω–∏–¥–∞–Ω –º—É–¥–¥–∞—Ç–ª–∏ —Ç—û–ª–æ–≤ –∞—Å–æ—Å–∏–¥–∞, —Ç—û–ª–æ–≤ –≥—Ä–∞—Ñ–∏–≥–∏–¥–∞ –∫—û—Ä—Å–∞—Ç–∏–ª–≥–∞–Ω –º—É–¥–¥–∞—Ç–ª–∞—Ä–≥–∞ –º—É–≤–æ—Ñ–∏“õ —Ç—û–ª–∞–± –±–æ—Ä–∏–ª–∞–¥–∏ (2-–∏–ª–æ–≤–∞).")
    
    add_p("3. –¢–æ–≤–∞—Ä–Ω–∏ —Ç–∞“õ–¥–∏–º “õ–∏–ª–∏—à —Ç–∞—Ä—Ç–∏–±–∏", True, "center")
    add_p("3.1. ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù 1-–∏–ª–æ–≤–∞–¥–∞ –∫–µ–ª—Ç–∏—Ä–∏–ª–≥–∞–Ω —Ç–æ–≤–∞—Ä–ª–∞—Ä–Ω–∏, –®–∞—Ä—Ç–Ω–æ–º–∞–¥–∞ –∫—û—Ä—Å–∞—Ç–∏–ª–≥–∞–Ω —à–∞—Ä—Ç–ª–∞—Ä –∞—Å–æ—Å–∏–¥–∞, ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù —Ç–æ–º–æ–Ω–∏–¥–∞–Ω –±–∞—Ä—á–∞ “≥—É–∂–∂–∞—Ç–ª–∞—Ä, —à—É –∂—É–º–ª–∞–¥–∞–Ω, –º–∞–∂–±—É—Ä–∏—è—Ç–ª–∞—Ä —Ç–∞—ä–º–∏–Ω–æ—Ç–∏ —Ç—û“ì—Ä–∏ —Ä–∞—Å–º–∏–π–ª–∞—à—Ç–∏—Ä–∏–ª–∏–±, —Ç–∞“õ–¥–∏–º —ç—Ç–∏–ª–≥–∞–Ω–¥–∞ –µ—Ç–∫–∞–∑–∏–± –±–µ—Ä–∞–¥–∏.\n3.2. –¢–æ–≤–∞—Ä–ª–∞—Ä–Ω–∏ —Ç–∞“õ–¥–∏–º —ç—Ç–∏—à —Å–∞–Ω–∞—Å–∏ —Ç–æ–≤–∞—Ä–ª–∞—Ä–Ω–∏–Ω–≥ ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù —Ç–æ–º–æ–Ω–∏–¥–∞–Ω ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù–≥–∞ —Ç–æ–ø—à–∏—Ä–≥–∞–Ω —Å–∞–Ω–∞—Å–∏ “≥–∏—Å–æ–±–ª–∞–Ω–∏–±, ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù —Ç–æ–º–æ–Ω–∏–¥–∞–Ω “ö–∞–±—É–ª “õ–∏–ª–∏—à-—Ç–æ–ø—à–∏—Ä–∏—à –¥–∞–ª–æ–ª–∞—Ç–Ω–æ–º–∞—Å–∏ –∏–º–∑–æ–ª–∞–Ω–∏—à–∏ –±–∏–ª–∞–Ω —Ç–∞—Å–¥–∏“õ–ª–∞–Ω–∞–¥–∏.\n3.3. –¢–æ–≤–∞—Ä–ª–∞—Ä ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù–≥–∞ —É—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–¥–∞ –±–µ–ª–≥–∏–ª–∞–Ω–≥–∞–Ω —Ç—û–ª–æ–≤ —à–∞—Ä—Ç–ª–∞—Ä–∏–¥–∞ –µ—Ç–∫–∞–∑–∏–± –±–µ—Ä–∏–ª–∞–¥–∏")
    
    add_p("4. –¢–æ–≤–∞—Ä–ª–∞—Ä–≥–∞ —Ç—û–ª–æ–≤ –∫–∏—Ä–∏—Ç–∏—à —Ç–∞—Ä—Ç–∏–±–∏", True, "center")
    add_p("4.1. –¢–æ–≤–∞—Ä–ª–∞—Ä–≥–∞ —Ç—û–ª–æ–≤ ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù —Ç–æ–º–æ–Ω–∏–¥–∞–Ω, —Ç–∞—Ä–∞—Ñ–ª–∞—Ä —Ç–æ–º–æ–Ω–∏dan –∫–µ–ª–∏—à–∏–ª–≥–∞–Ω –≤–∞ —É—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–Ω–∏–Ω–≥ –∞–∂—Ä–∞–ª–º–∞—Å “õ–∏—Å–º–∏ –±—û–ª–≥–∞–Ω 2-–∏–ª–æ–≤–∞–¥–∞ –±–µ–ª–≥–∏–ª–∞–Ω–≥–∞–Ω –∂–∞–¥–≤–∞–ª–≥–∞ –º—É–≤–æ—Ñ–∏“õ –∞–º–∞–ª–≥–∞ –æ—à–∏—Ä–∏–ª–∞–¥–∏.\n4.2. –¢–æ–≤–∞—Ä–ª–∞—Ä —É—á—É–Ω –æ–ª–¥–∏–Ω–¥–∞–Ω —Ç—û–ª–æ–≤ ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù —Ç–æ–º–æ–Ω–∏–¥–∞–Ω –∏—Å—Ç–∞–ª–≥–∞–Ω —à–∞–∫–ª–¥–∞, –é–∑–±–µ–∫–∏—Å—Ç–æ–Ω –†–µ—Å–ø—É–±–ª–∏–∫–∞—Å–∏ “õ–æ–Ω—É–Ω—á–∏–ª–∏–≥–∏–≥–∞ –∑–∏–¥ –±—û–ª–º–∞–≥–∞–Ω —Ö–æ–ª–¥–∞ —û—Ä–Ω–∞—Ç–∏–ª–≥–∞–Ω —Ç–∞—Ä—Ç–∏–±–¥–∞ –∞–º–∞–ª–≥–∞ –æ—à–∏—Ä–∏–ª–∞–¥–∏.\n4.3. –¢–æ–≤–∞—Ä —É—á—É–Ω —Ç—û–ª–æ–≤ —Å—É–º–º–∞—Å–∏–Ω–∏–Ω–≥ “õ–æ–ª–≥–∞–Ω “õ–∏—Å–º–∏ ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù –Ω–∏–Ω–≥ —Ç–∞–Ω–ª–æ–≤–∏–≥–∞ –∞—Å–æ—Å–∞–Ω “õ—É–π–∏–¥–∞–≥–∏ —à–∞–∫–ª–¥–∞ —Ç—û–ª–∞–Ω–∞–¥–∏:\n1) ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù–Ω–∏–Ω–≥–¥–∞—Å—Ç—É—Ä–∏–¥–∞ –±–∞–Ω–∫ –ø–ª–∞—Å—Ç–∏–∫ (UzCARD / HUMO –≤–∞ —Ç–∏–∑–∏–º–≥–∞ —É–ª–∞–Ω–≥–∞–Ω –±–æ—à“õ–∞ –ø–ª–∞—Å—Ç–∏–∫) –∫–∞—Ä—Ç–∞—Å–∏–¥–∞–Ω —Ñ–æ–π–¥–∞–ª–∞–Ω–≥–∞–Ω “≥–æ–ª–¥–∞;\n2) ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù–Ω–∏–Ω–≥ —É—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–¥–∞ –∫—û—Ä—Å–∞—Ç–∏–ª–≥–∞–Ω “≥–∏—Å–æ–± —Ä–∞“õ–∞–º–∏–≥–∞ –ø—É–ª –º–∞–±–ª–∞“ì–ª–∞—Ä–∏–Ω–∏ —û—Ç–∫–∞–∑–∏—à —É—á—É–Ω, —Ç–∏–∂–æ—Ä–∞—Ç –±–∞–Ω–∫–∏–≥–∞ –Ω–∞“õ–¥ –ø—É–ª —Ç–æ–ø—à–∏—Ä–≥–∞–Ω “≥–æ–ª–¥–∞;\n3) “õ–æ–Ω—É–Ω—á–∏–ª–∏–∫–¥–∞ —û—Ä–Ω–∞—Ç–∏–ª–≥–∞–Ω —Ç–∞—Ä—Ç–∏–±–¥–∞ ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù–Ω–∏–Ω–≥ –∫–∞—Å—Å–∞—Å–∏–≥–∞ –Ω–∞“õ–¥ –ø—É–ª —Ç–æ–ø—à–∏—Ä–≥–∞–Ω “≥–æ–ª–¥–∞.\n4) “õ–æ–Ω—É–Ω—á–∏–ª–∏–∫–¥–∞ —û—Ä–Ω–∞—Ç–∏–ª–≥–∞–Ω —Ç–∞—Ä—Ç–∏–±–¥–∞ ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù–Ω–∏–Ω–≥, –±–∞–Ω–∫ —Ç–µ—Ä–º–∏–Ω–∞–ª–∏ –æ—Ä“õ–∞–ª–∏ –±–∞–Ω–∫ –∫–∞—Ä—Ç–∞—Å–∏–¥–∞–Ω —Ç—û–ª–æ–≤–ª–∞—Ä–Ω–∏ —Ç—û–ª–∞—à –æ—Ä“õ–∞–ª–∏\n5) –é–∑–±–µ–∫–∏—Å—Ç–æ–Ω –†–µ—Å–ø—É–±–ª–∏–∫–∞—Å–∏ “õ–æ–Ω—É–Ω—á–∏–ª–∏–≥–∏–≥–∞ –∑–∏–¥ –±—û–ª–º–∞–≥–∞–Ω –±–æ—à“õ–∞ —à–∞–∫–ª–ª–∞—Ä–¥–∞\n4.4. ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù —Ç–æ–º–æ–Ω–∏–¥–∞–Ω —Ç—û–ª–∞–Ω–≥–∞–Ω –ø—É–ª –º–∞–±–ª–∞“ì–ª–∞—Ä–∏, ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù–Ω–∏–Ω–≥ ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù –æ–ª–¥–∏–¥–∞ –±—É—Ç—É–Ω –º–∞–≤–∂—É–¥ “õ–∞—Ä–∑–¥–æ—Ä–ª–∏–≥–∏–Ω–∏ “õ–æ–ø–ª–∞—à–≥–∞ –µ—Ç–º–∞—Å–∞, –∞–≤–≤–∞–ª–æ, —Ç—û–ª–æ–≤–ª–∞—Ä–Ω–∏ —û–∑ –≤–∞“õ—Ç–∏–¥–∞ —Ç—û–ª–∞–º–∞–≥–∞–Ω–ª–∏–∫ —É—á—É–Ω –∂–∞—Ä–∏–º–∞ —Ç—û–ª–æ–≤–∏–≥–∞, —Å—û–Ω–≥—Ä–∞ ")

    # --- 2-SAHIFA ---
    doc.add_page_break()
    add_p("2. ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù–≥–∞ –µ—Ç–∫–∞–∑–∏–ª–≥–∞–Ω –∑–∞—Ä–∞—Ä–ª–∞—Ä–Ω–∏ “õ–æ–ø–ª–∞—à–≥–∞, “õ–æ–ª–≥–∞–Ω “õ–∏—Å–º–∏ —ç—Å–∞ —Ç–æ–≤–∞—Ä–ª–∞—Ä —É—á—É–Ω —Ç—û–ª–æ–≤ —Å—É–º–º–∞—Å–∏–Ω–∏ “õ–æ–ø–ª–∞—à–≥–∞ –π—û–Ω–∞–ª—Ç–∏—Ä–∏–ª–∞–¥–∏.")
    add_p("4.5. “ö–æ–ø–ª–∞–Ω–∏—à–∏ –ª–æ–∑–∏–º –±—û–ª–≥–∞–Ω –∑–∞—Ä–∞—Ä–ª–∞—Ä–≥–∞ “õ—É–π–∏–¥–∞–≥–∏–ª–∞—Ä –∫–∏—Ä–∞–¥–∏:\n- –±—û–ª–∏–± —Ç—û–ª–∞—à —Å—É–º–º–∞—Å–∏–Ω–∏ “õ–∞–π—Ç–∞—Ä–∏—à –º—É–¥–¥–∞—Ç–∏–Ω–∏ —û—Ç–∫–∞–∑–∏–± —é–±–æ—Ä–≥–∞–Ω–¥–∞ ‚Äì –æ–ª–∏–Ω–º–∞–π “õ–æ–ª–≥–∞–Ω –¥–∞—Ä–æ–º–∞–¥ –∫—û—Ä–∏–Ω–∏—à–∏–¥–∞–≥–∏ –∑–∞—Ä–∞—Ä–ª–∞—Ä ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù–Ω–∏–Ω–≥ –º–∞–±–ª–∞“ì–ª–∞—Ä–∏–¥–∞–Ω —Ñ–æ–π–¥–∞–ª–∞–Ω–≥–∞–Ω–ª–∏–≥–∏ –æ“õ–∏–±–∞—Ç–∏–¥–∞ –≤—É–∂—É–¥–≥–∞ –∫–µ–ª–≥–∞–Ω–¥–∞ –é–∑–±–µ–∫–∏—Å—Ç–æ–Ω –†–µ—Å–ø—É–±–ª–∏–∫–∞—Å–∏ –ú–∞—Ä–∫–∞–∑–∏–π –±–∞–Ω–∫–∏–Ω–∏–Ω–≥ “õ–∞–π—Ç–∞ –º–æ–ª–∏—è–ª–∞—à —Å—Ç–∞–≤–∫–∞—Å–∏–≥–∞ –∞—Å–æ—Å–∞–Ω, ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù–≥–∞ –Ω–∏—Å–±–∞—Ç–∞–Ω —Ç–∞–ª–∞–± –±–∏–ª–∞–Ω —á–∏“õ“õ–∞–Ω –∫—É–Ω–∏–≥–∞ “≥–∏—Å–æ–±–ª–∞–Ω–∞–¥–∏;\n- ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù–¥–∞–Ω –º–∞–∂–±—É—Ä–∏—è—Ç–ª–∞—Ä–∏–Ω–∏–Ω–≥ –±–∞–∂–∞—Ä–∏—à–∏–Ω–∏ —Ç–∞–ª–∞–± “õ–∏–ª–∏—à –º–∞“õ—Å–∞–¥–∏–¥–∞ –±–æ—à“õ–∞ —Ç–∞—à–∫–∏–ª–æ—Ç–≥–∞ —û—Ç–∫–∞–∑–≥–∞–Ω “≥–∞—Ä–∞–∂–∞—Ç–ª–∞—Ä–∏.")
    add_p("5. –°–æ—Ç—É–≤—á–∏–Ω–∏–Ω–≥ –Ω–∞–∑–æ—Ä–∞—Ç–∏", True, "center")
    add_p("5.1. ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù —É–Ω–≥–∞ –Ω–∏—Å–±–∞—Ç–∞–Ω “õ—û–π–∏–ª–≥–∞–Ω –±–∞—Ä—á–∞ –¥–∞—ä–≤–æ–ª–∞—Ä, —É–Ω–≥–∞ –Ω–∏—Å–±–∞—Ç–∞–Ω –∏–∂—Ä–æ –∏—à–ª–∞–± —á–∏“õ–∞—Ä–∏—à–∏ “õ—û–∑“ì–∞—Ç–∏–ª–≥–∞–Ω–∏, –∏—Å–º–∏, —Ñ–∞–º–∏–ª–∏—è—Å–∏, –æ—Ç–∞—Å–∏–Ω–∏–Ω–≥ –∏—Å–º–∏ —û–∑–≥–∞—Ä—Ç–∏—Ä–∏–ª–≥–∞–Ω–∏, —Ç—É—Ä–∞—Ä –∂–æ–π –º–∞–Ω–∑–∏–ª–∏, –∏—à –∂–æ–π–∏–Ω–∏–Ω–≥ —û–∑–≥–∞—Ä–∏—à–∏, –ø–∞—Å–ø–æ—Ä—Ç –º–∞—ä–ª—É–º–æ—Ç–ª–∞—Ä–∏–Ω–∏–Ω–≥ —û–∑–≥–∞—Ä–∏—à–∏, “≥–∞–º–¥–∞ ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù —Ç–æ–º–æ–Ω–∏–¥–∞–Ω —É—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–≥–∞ –∞—Å–æ—Å–∞–Ω –º–∞–∂–±—É—Ä–∏—è—Ç–ª–∞—Ä–∏–Ω–∏–Ω–≥ –±–∞–∂–∞—Ä–∏–ª–∏—à–∏–≥–∞ —Ç–∞—ä—Å–∏—Ä “õ–∏–ª–∏—à–∏ –º—É–º–∫–∏–Ω –±—û–ª–≥–∞–Ω –±–æ—à“õ–∞ —û–∑–≥–∞—Ä–∏—à–ª–∞—Ä “≥–∞“õ–∏–¥–∞ –º–∞—ä–ª—É–º–æ—Ç —Å—û—Ä–∞—à –≤–∞ “õ–∏–¥–∏—Ä–∏—à “≥—É“õ—É“õ–∏–≥–∞ —ç–≥–∞.")
    add_p("6. ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù–Ω–∏–Ω–≥ —É—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–≥–∞ –º—É–≤–æ—Ñ–∏“õ –º–∞–∂–±—É—Ä–∏—è—Ç–ª–∞—Ä–∏–Ω–∏ –±–∞–∂–∞—Ä–∏—à–∏ –∫–∞—Ñ–æ–ª–∞—Ç–ª–∞—Ä–∏", True, "center")
    add_p("6.1. ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù–Ω–∏–Ω–≥ —É—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–≥–∞ –º—É–≤–æ—Ñ–∏“õ –º–∞–∂–±—É—Ä–∏—è—Ç–ª–∞—Ä–∏–Ω–∏–Ω–≥ –±–∞–∂–∞—Ä–∏—à–∏ –∫–∞—Ñ–æ–ª–∞—Ç–∏ —Å–∏—Ñ–∞—Ç–∏–¥–∞ –∫–∞—Ñ–∏–ª–ª–∏–∫ —ë–∫–∏ ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù–Ω–∏–Ω–≥ —ë–∫–∏ ‚Äú–ö–∞—Ñ–∏–ª–Ω–∏–Ω–≥‚Äù –±–∞–Ω–∫ –ø–ª–∞—Å—Ç–∏–∫ –∫–∞—Ä—Ç–∞—Å–∏–¥–∞–≥–∏ –ø—É–ª –º–∞–±–ª–∞“ì–ª–∞—Ä–∏, “≥–∞–º–¥–∞ –é–∑–±–µ–∫–∏—Å—Ç–æ–Ω –†–µ—Å–ø—É–±–ª–∏–∫–∞—Å–∏–Ω–∏–Ω–≥ –∞–º–∞–ª–¥–∞–≥–∏ “õ–æ–Ω—É–Ω—á–∏–ª–∏–≥–∏–≥–∞ –º—É–≤–æ—Ñ–∏“õ, —Ç–∞—ä–º–∏–Ω–æ—Ç–Ω–∏–Ω–≥ –±–æ—à“õ–∞ —Ç—É—Ä–ª–∞—Ä–∏ —Ö–∏–∑–º–∞—Ç “õ–∏–ª–∏—à–∏ –º—É–º–∫–∏–Ω.\n6.2. –¢–∞—ä–º–∏–Ω–æ—Ç–Ω–∏ –±–µ–ª–≥–∏–ª–æ–≤—á–∏ “≥—É–∂–∂–∞—Ç–ª–∞—Ä, —É—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–Ω–∏–Ω–≥ –∞–∂—Ä–∞–ª–º–∞—Å “õ–∏—Å–º–∏ –¥–µ–± “≥–∏—Å–æ–±–ª–∞–Ω–∞–¥–∏.")
    add_p("7. ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù–Ω–∏–Ω–≥ —Ç–∞–ª–∞–±–∏–≥–∞ –∫—û—Ä–∞ “õ–∞—Ä–∑–Ω–∏–Ω–≥ “õ–æ–ª–≥–∞–Ω “õ–∏—Å–º–∏–Ω–∏ –º—É–¥–¥–∞—Ç–¥–∞–Ω –æ–ª–¥–∏–Ω “õ–∞–π—Ç–∞—Ä–∏–ª–∏—à–∏", True, "center")
    add_p("7.1. ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù –º–æ–ª–∏—è–≤–∏–π “≥–æ–ª–∞—Ç–∏ —ë–º–æ–Ω–ª–∞—à–≥–∞–Ω–∏–¥–∞, “≥–∞–º–¥–∞, “õ—É–π–∏–¥–∞–≥–∏ “≥–æ–ª–∞—Ç–ª–∞—Ä–¥–∞, “õ–∞—Ä–∑–Ω–∏–Ω–≥ “õ–æ–ª–≥–∞–Ω “õ–∏—Å–∏–º–Ω–∏ –º—É–¥–¥–∞—Ç–¥–∞–Ω –æ–ª–¥–∏–Ω “õ–∞–π—Ç–∞—Ä–∏–ª–∏—à–∏–Ω–∏ —Ç–∞–ª–∞–± “õ–∏–ª–∏—à–≥–∞ “≥–∞“õ–ª–∏:\n-‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù —Ç–æ–º–æ–Ω–∏–¥–∞–Ω, —Ç—û–ª–æ–≤ –≥—Ä–∞—Ñ–∏–≥–∏ —Ç–æ–º–æ–Ω–∏–¥–∞–Ω —û—Ä–Ω–∞—Ç–∏–ª–≥–∞–Ω —Å—É–º–º–∞ –±—û–π–∏—á–∞ –Ω–∞–≤–±–∞—Ç–¥–∞–≥–∏ —Ç—û–ª–æ–≤–Ω–∏ –∫–µ—á–∏–∫—Ç–∏—Ä–∏—à–∏ (2-–∏–ª–æ–≤–∞);\n-‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù —Ç–æ–º–æ–Ω–∏–¥–∞–Ω —É—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–Ω–∏–Ω–≥, —É–Ω–∏–Ω–≥ –®–∞—Ä—Ç–Ω–æ–º–∞–≥–∞ –º—É–≤–æ—Ñ–∏“õ –º–∞–∂–±—É—Ä–∏—è—Ç–ª–∞—Ä–∏–Ω–∏ –±–µ–ª–≥–∏–ª–æ–≤—á–∏ —à–∞—Ä—Ç–ª–∞—Ä–Ω–∏ –±—É–∑–∏—à–∏, —ë–∫–∏ ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù “≥—É“õ—É“õ–ª–∞—Ä–∏–Ω–∏ “õ–æ–Ω–¥–∏—Ä–∏—à —à–∞—Ä—Ç–ª–∞—Ä–∏–Ω–∏–Ω–≥ —ë–º–æ–Ω–ª–∞—à–∏—à–∏ —ë–∫–∏ –∏–ª–æ–∂—Å–∏–∑ “õ–∏–ª–∏—à–∏ –º—É–º–∫–∏–Ω –±—û–ª–≥–∞–Ω –±–æ—à“õ–∞ –≤–∞–∑–∏—è—Ç–ª–∞—Ä.")
    add_p("7.2. –£—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–Ω–∏–Ω–≥ 7.1. –±–∞–Ω–¥–∏–¥–∞ –∫—û–∑–¥–∞ —Ç—É—Ç–∏–ª–≥–∞–Ω –≤–∞–∑–∏—è—Ç–ª–∞—Ä –≤—É–∂—É–¥–≥–∞ –∫–µ–ª–≥–∞–Ω–¥–∞, ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù–¥–∞–Ω “õ–∞—Ä–∑–Ω–∏ –º—É–¥–¥–∞—Ç–¥–∞–Ω –æ–ª–¥–∏–Ω —Å—û–Ω–¥–∏—Ä–∏—à–Ω–∏ —Ç–∞–ª–∞–± “õ–∏–ª–∏—à–∏ –º—É–º–∫–∏–Ω. –ë—É “≥–æ–ª–¥–∞, ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù–≥–∞ —ë–∑–º–∞ —Ç–∞–ª–∞–±–Ω–æ–º–∞ –∂—û–Ω–∞—Ç–∞–¥–∏, –±—É–Ω–¥–∞–Ω —Å—û–Ω–≥, ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù —Ç–∞–ª–∞–±–Ω–æ–º–∞–Ω–∏ –æ–ª–≥–∞–Ω –∫—É–Ω–∏–¥–∞–Ω –±–æ—à–ª–∞–± 3 (—É—á) –∫–∞–ª–µ–Ω–¥–∞—Ä –∫—É–Ω–∏ –∏—á–∏–¥–∞, —ë–∫–∏ –±—É—é—Ä—Ç–º–∞ —Ö–∞—Ç –±–∏–ª–∞–Ω –∂—û–Ω–∞—Ç–∏–ª–≥–∞–Ω —Ç–∞–ª–∞–±–Ω–æ–º–∞-—Ö–∞—Ç–∏ –∂—û–Ω–∞—Ç–∏–ª–≥–∞–Ω –∫—É–Ω–¥–∞–Ω –±–æ—à–ª–∞–± 5 (–±–µ—à) –∫–∞–ª–µ–Ω–¥–∞—Ä –∫—É–Ω–∏ –∏—á–∏–¥–∞ —Ç–æ–≤–∞—Ä–ª–∞—Ä —É—á—É–Ω –±—É—Ç—É–Ω —Å—É–º–º–∞–Ω–∏ —Ç—û–ª–∏“õ —Å—û–Ω–¥–∏—Ä–∏—à–∏ –ª–æ–∑–∏–º.")
    add_p("8. –¢–∞—Ä–∞—Ñ–ª–∞—Ä–Ω–∏–Ω–≥ –º–∞–∂–±—É—Ä–∏—è—Ç–ª–∞—Ä–∏", True, "center")
    add_p("8.1. ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù “õ—É–π–∏–¥–∞–≥–∏ –º–∞–∂–±—É—Ä–∏—è—Ç–ª–∞—Ä–≥–∞ —ç–≥–∞:\n8.1.1. –£—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–¥–∞ –∫—û–∑–¥–∞ —Ç—É—Ç–∏–ª–≥–∞–Ω —Ç–æ–≤–∞—Ä–Ω–∏, 1-–∏–ª–æ–≤–∞–≥–∞ –º—É–≤–æ—Ñ–∏“õ —Å–∏—Ñ–∞—Ç–¥–∞, –º–∏“õ–¥–æ—Ä–¥–∞ –≤–∞ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–¥–∞ –µ—Ç–∫–∞–∑–∏–± –±–µ—Ä–∏—à.\n8.2. ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù “õ—É–π–∏–¥–∞–≥–∏ –º–∞–∂–±—É—Ä–∏—è—Ç–ª–∞—Ä–≥–∞ —ç–≥–∞:\n8.2.1. –£—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–≥–∞ –º—É–≤–æ—Ñ–∏“õ –µ—Ç–∫–∞–∑–∏–± –±–µ—Ä–∏–ª–≥–∞–Ω —Ç–æ–≤–∞—Ä–Ω–∏ –∞–≤–≤–∞–ª–¥–∞–Ω –∫—û—Ä–∏–± –æ–ª–∏—à, —Ç–æ–≤–∞—Ä–Ω–∏–Ω–≥ —Å–∏—Ñ–∞—Ç–∏, –º–∏“õ–¥–æ—Ä–∏ –≤–∞ –∞—Å—Å–æ—Ä—Ç–∏–º–µ–Ω—Ç–∏, 1-–∏–ª–æ–≤–∞–¥–∞ –∫–µ–ª—Ç–∏—Ä–∏–ª–≥–∞–Ω —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è–≥–∞ –º—É–≤–æ—Ñ–∏“õ —ç–∫–∞–Ω–ª–∏–≥–∏–≥–∞ –∏—à–æ–Ω—á “≥–æ—Å–∏–ª “õ–∏–ª–∏—à.")

    # --- 3-SAHIFA ---
    doc.add_page_break()
    add_p("8.2.2. –£—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–Ω–∏–Ω–≥ –∞–∂—Ä–∞–ª–º–∞—Å “õ–∏—Å–º–∏ “≥–∏—Å–æ–±–ª–∞–Ω–º–∏—à 2-–∏–ª–æ–≤–∞–¥–∞ –∫–µ–ª—Ç–∏—Ä–∏–ª–≥–∞–Ω –∂–∞–¥–≤–∞–ª–≥–∞ –º—É–≤–æ—Ñ–∏“õ —Ç–æ–≤–∞—Ä —É—á—É–Ω —Ç—û–ª–æ–≤–ª–∞—Ä–Ω–∏ –∫—û–∑–¥–∞ —Ç—É—Ç–∏–ª–≥–∞–Ω –º—É–¥–¥–∞—Ç –≤–∞ —Å—É–º–º–∞–¥–∞ —Ç—û–ª–∞–± –±–æ—Ä–∏—à.")
    add_p("8.2.4. –£—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–≥–∞ –º—É–≤–æ—Ñ–∏“õ —Ç—û–ª–∞–Ω–∏—à–∏ –ª–æ–∑–∏–º –±—û–ª–≥–∞–Ω —Ç—û–ª–æ–≤–ª–∞—Ä–≥–∞ –æ–∏–¥ –º–∞–∂–±—É—Ä–∏—è—Ç–ª–∞—Ä–Ω–∏ –±–∞–∂–∞—Ä–∏—à —É—á—É–Ω, ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù–≥–∞ —û–∑–∏–Ω–∏–Ω–≥ –±–∞–Ω–∫ “≥–∏—Å–æ–± —Ä–∞“õ–∞–º–ª–∞—Ä–∏ –≤–∞/—ë–∫–∏ –º–∞–≤–∂—É–¥ –±–∞–Ω–∫ –ø–ª–∞—Å—Ç–∏–∫ –∫–∞—Ä—Ç–∞–ª–∞—Ä–∏–¥–∞–Ω –º–∞–±–ª–∞“ì–ª–∞—Ä–Ω–∏ –∞–∫—Ü–µ–ø—Ç—Å–∏–∑ —Ä–∞–≤–∏—àda —É—à–ª–∞–± “õ–æ–ª–∏—à “≥—É“õ—É“õ–∏–Ω–∏ –±–µ—Ä–∏—à.")
    add_p("8.2.8 ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù —à–∞—Ä—Ç–Ω–æ–º–∞ –¥–æ–∏—Ä–∞—Å–∏–¥–∞ —Ç—û–ª–∞–Ω–∞–¥–∏–≥–∞–Ω –æ–π–ª–∏–∫ —Ç—û–ª–æ–≤–ª–∞—Ä–Ω–∏ –∫–µ—á–∏–∫—Ç–∏—Ä–∏–± —Ç—û–ª–∞—à “≥–æ–ª–ª–∞—Ä–∏–¥–∞ ‚ÄúC–æ—Ç—É–≤—á–∏‚Äù–≥–∞ –º—É–¥–¥–∞—Ç–∏–¥–∞–Ω –æ–ª–¥–∏–Ω —É–Ω–≥–∞ —Ç–µ–≥–∏—à–ª–∏ –±—û–ª–≥–∞–Ω “≥–∞—Ä “õ–∞–Ω–¥–∞–π –±–∞–Ω–∫ –∫–∞—Ä—Ç–∞–ª–∞—Ä–∏–¥–∞–Ω –µ—á–∏–± –æ–ª–∏—à —Ö—É“õ—É“õ–∏–Ω–∏ –±–µ—Ä–∏—à, –±—É–Ω–¥–∞–π “≥–æ–ª–ª–∞—Ä–¥–∞ ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù–≥–∞ “≥–µ—á “õ–∞–Ω–¥–∞–π —ç—ä—Ç–∏—Ä–æ–∑ –≤–∞ –¥–∞—ä–≤–æ “õ–∏–ª–º–∞–π–¥–∏.")
    add_p("9. –¢–∞—Ä–∞—Ñ–ª–∞—Ä–Ω–∏–Ω–≥ “≥—É“õ—É“õ–ª–∞—Ä–∏", True, "center")
    add_p("9.1. ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù “õ—É–π–∏–¥–∞–≥–∏ “≥—É“õ—É“õ–ª–∞—Ä–≥–∞ —ç–≥–∞:\n9.1.1. –£—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–¥–∞ –∫—û–∑–¥–∞ —Ç—É—Ç–∏–ª–≥–∞–Ω —Ç–æ–≤–∞—Ä —É—á—É–Ω —Ç—û–ª–æ–≤–Ω–∏ —û–∑ –≤–∞“õ—Ç–∏–¥–∞ —Ç—û–ª–∞–± –±–æ—Ä–∏—à “õ–æ–±–∏–ª–∏—è—Ç–∏ –≤–∞ –ª–æ—è–ª–ª–∏–≥–∏–Ω–∏ —Ç–∞—Å–¥–∏“õ–ª–æ–≤—á–∏ –∑–∞—Ä—É—Ä “≥—É–∂–∂–∞—Ç–ª–∞—Ä–Ω–∏ ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù–¥–∞–Ω —Ç–∞–ª–∞–± “õ–∏–ª–∏—à.\n9.1.8. –£—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞ —Ç–∞–ª–∞–±–ª–∞—Ä–∏–≥–∞ –∞—Å–æ—Å–∞–Ω ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù —Ç–æ–º–æ–Ω–∏–¥–∞–Ω —Ç—û–ª–∞–Ω–∏—à–∏ –ª–æ–∑–∏–º –±—û–ª–≥–∞–Ω –º–∞–±–ª–∞“ì–ª–∞—Ä —û–∑ –≤–∞“õ—Ç–∏–¥–∞ —Ç—û–ª–∞–Ω–º–∞–≥–∞–Ω–¥–∞, —É–Ω–∏–Ω–≥ —à–∞—Ö—Å–∏–π –º–∞—ä–ª—É–º–æ—Ç–ª–∞—Ä–∏ –≤–∞ –±–æ—à“õ–∞ –∞—Ö–±–æ—Ä–æ—Ç–ª–∞—Ä–Ω–∏ —Ç—É—Ä–ª–∏ –º–∞–Ω–±–∞ –≤–∞ –∂–æ–π–ª–∞—Ä–¥–∞ –æ—à–∫–æ—Ä “õ–∏–ª–∏—à, –±–∞–Ω–∫ –∫–∞—Ä—Ç–∞–ª–∞—Ä–∏–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏–∫ —Ç–∞—Ä–∑–¥–∞ –ø—É–ª –µ—á–∏—à —Ç–∏–∑–∏–º–ª–∞—Ä–∏–≥–∞ –±–∞—Ä—á–∞ –º–∞—ä–ª—É–º–æ—Ç–ª–∞—Ä–Ω–∏ —Ç–∞“õ–¥–∏–º “õ–∏–ª–∏—à.")
    add_p("9.2. ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù “õ—É–π–∏–¥–∞–≥–∏ “≥—É“õ—É“õ–ª–∞—Ä–≥–∞ —ç–≥–∞:\n9.2.1. –£—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞ —à–∞—Ä—Ç–ª–∞—Ä–∏–¥–∞ —Ç–æ–≤–∞—Ä–Ω–∏ —Ç–∞“õ–¥–∏–º “õ–∏–ª–∏—à “õ–æ–∏–¥–∞–ª–∞—Ä–∏ –±–∏–ª–∞–Ω —Ç–∞–Ω–∏—à–∏–± —á–∏“õ–∏—à.\n9.2.4. –°–∏—Ñ–∞—Ç –∂–∏“≥–∞—Ç–¥–∞–Ω –Ω–æ–º—É–≤–æ—Ñ–∏“õ —Ç–æ–≤–∞—Ä–Ω–∏–Ω–≥ –∞–ª–º–∞—à—Ç–∏—Ä–∏–± –±–µ—Ä–∏–ª–∏—à–∏–Ω–∏ —Ç–∞–ª–∞–± “õ–∏–ª–∏—à.")

    # --- 4-SAHIFA ---
    doc.add_page_break()
    add_p("10. –¢–∞—Ä–∞—Ñ–ª–∞—Ä–Ω–∏–Ω–≥ –º–∞—Å—ä—É–ª–∏—è—Ç–∏", True, "center")
    add_p(f"10.5. –ñ–∞–¥–≤–∞–ª–≥–∞ (2-–∏–ª–æ–≤–∞) –º—É–≤–æ—Ñ–∏“õ –±–µ–ª–≥–∏–ª–∞–Ω–≥–∞–Ω —Ç—û–ª–æ–≤ –º—É–¥–¥–∞—Ç–ª–∞—Ä–∏ —û—Ç–≥–∞–Ω–∏–¥–∞–Ω —Å—û–Ω–≥, ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù–¥–∞–Ω —Ç—û–ª–æ–≤ –∫–µ—á–∏–∫—Ç–∏—Ä–∏–ª–≥–∞–Ω “≥–∞—Ä –±–∏—Ä –∫—É–Ω —É—á—É–Ω —Ç—û–ª–∞–Ω–º–∞–≥–∞–Ω —Å—É–º–º–∞–¥–∞–Ω 2,0 % –º–∏“õ–¥–æ—Ä–∏–¥–∞, –±–∏—Ä–æ“õ –º—É–¥–¥–∞—Ç–∏ —û—Ç–≥–∞–Ω —Ç—û–ª–æ–≤–Ω–∏–Ω–≥ 50 %–∏–¥–∞–Ω –æ—à–º–∞–≥–∞–Ω “≥–æ–ª–¥–∞ –∂–∞—Ä–∏–º–∞ —Ç—û–ª–∞—à–Ω–∏ —Ç–∞–ª–∞–± “õ–∏–ª–∏—à–∏ –º—É–º–∫–∏–Ω.")
    add_p("10.8. –ê–≥–∞—Ä ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù —É—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–Ω–∏–Ω–≥ 10.7 –±–∞–Ω–¥–∏–¥–∞ –∫—û–∑–¥–∞ —Ç—É—Ç–∏–ª–≥–∞–Ω —Ç–∞—Ä—Ç–∏–±–¥–∞ —Ö–∞–±–∞—Ä–Ω–æ–º–∞ –æ–ª–≥–∞–Ω–∏–¥–∞–Ω —Å—û–Ω–≥ —Ç—û–ª–∞–Ω–∏—à–∏ –ª–æ–∑–∏–º –±—û–ª–≥–∞–Ω —Ç—û–ª–æ–≤–ª–∞—Ä–Ω–∏ –∞–º–∞–ª–≥–∞ –æ—à–∏—Ä–º–∞—Å–∞, ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù —Ç–æ–º–æ–Ω–∏–¥–∞–Ω –º–∞—Å–æ—Ñ–∞–¥–∞–Ω —Ç—É—Ä–∏–± —É—è–ª–∏ –∞–ª–æ“õ–∞ –≤–æ—Å–∏—Ç–∞—Å–∏ –º–∞—Ö—Å—É—Å ‚Äú–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä‚Äù (Apple ID yoki Gmail) –æ—Ä“õ–∞–ª–∏ “õ—É–ª–∏—Ñ–≥–∞ —Å–æ–ª–∏–Ω–∏—à–∏ –º—É–º–∫–∏–Ω.")
    add_p("11. –¢–æ–≤–∞—Ä–ª–∞—Ä–Ω–∏ —Ç–æ–ø—à–∏—Ä–∏—à —à–∞—Ä—Ç–ª–∞—Ä–∏", True, "center")
    add_p("11.1. –¢–æ–≤–∞—Ä–ª–∞—Ä–Ω–∏ —Ç–æ–ø—à–∏—Ä–∏—à —Ñ–∞“õ–∞—Ç–≥–∏–Ω–∞ ‚Äú–•–∞—Ä–∏–¥–æ—Ä‚Äù, —è—ä–Ω–∏ —à–∞—Ä—Ç–Ω–æ–º–∞–Ω–∏ —Ç—É–∑–≥–∞–Ω —à–∞—Ö—Å–≥–∞ —Ç–∞“õ–¥–∏–º etilgan “≥—É–∂–∂–∞—Ç–ª–∞—Ä –∞—Å–æ—Å–∏–¥–∞ –∞–º–∞–ª–≥–∞ –æ—à–∏—Ä–∏–ª–∞–¥–∏.\n11.2. –¢–æ–≤–∞—Ä–ª–∞—Ä–Ω–∏ —Ç–æ–ø—à–∏—Ä–∏—à –≤–∞“õ—Ç–∏–¥–∞ –°–æ—Ç—É–≤—á–∏ —Ç–æ–º–æ–Ω–∏–¥–∞–Ω —É—à–±—É —Ç–æ–≤–∞—Ä–ª–∞—Ä —É—è–ª–∏ –∞–ª–æ“õ–∞ –≤–æ—Å–∏—Ç–∞—Å–∏ –±—û–ª—Å–∞ —à–∞—Ä—Ç–Ω–æ–º–∞ –º—É–¥–¥–∞—Ç–∏ —è–∫—É–Ω–∏–≥–∞ “õ–∞–¥–∞—Ä –º–∞—Ö—Å—É—Å ‚Äú–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä‚Äù —û—Ä–Ω–∞—Ç–∏–± —Ç–æ–ø—à–∏—Ä–∏–ª–∞–¥–∏.")

    # --- 5-SAHIFA ---
    doc.add_page_break()
    add_p("12. –§–æ—Ä—Å-–º–∞–∂–æ—Ä –≤–∞–∑–∏—è—Çlar", True, "center")
    add_p("12.1. –¢–∞—Ä–∞—Ñ–ª–∞—Ä –µ–Ω–≥–∏–± –±—û–ª–º–∞—Å –∫—É—á–≥–∞ —ç–≥–∞ –≤–∞–∑–∏—è—Ç–ª–∞—Ä –æ“õ–∏–±–∞—Ç–∏–¥–∞ –º–∞–∂–±—É—Ä–∏—è—Ç–ª–∞—Ä–Ω–∏ –±–∞–∂–∞—Ä–∞ –æ–ª–º–∞—Å–∞, –∂–∞–≤–æ–±–≥–∞—Ä–ª–∏–∫–¥–∞–Ω –æ–∑–æ–¥ —ç—Ç–∏–ª–∞–¥–∏.")
    add_p("13. –®–∞—Ä—Ç–Ω–æ–º–∞–Ω–∏ —û–∑–≥–∞—Ä—Ç–∏—Ä–∏—à –≤–∞ –±–µ–∫–æ—Ä “õ–∏–ª–∏—à", True, "center")
    add_p("13.1. –£—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞–≥–∞ –∫–∏—Ä–∏—Ç–∏–ª–∏—à–∏ –º—É–º–∫–∏–Ω –±—û–ª–≥–∞–Ω “≥–∞—Ä “õ–∞–Ω–¥–∞–π —û–∑–≥–∞—Ä—Ç–∏—Ä–∏—à –≤–∞ “õ—û—à–∏–º—á–∞lar —Ñ–∞“õ–∞—Ç–≥–∏–Ω–∞ —ë–∑–º–∞ —Ä–∞–≤–∏—à–¥–∞ —Ç—É–∑–∏–ª–≥–∞–Ω –≤–∞ –¢–∞—Ä–∞—Ñ–ª–∞—Ä —Ç–æ–º–æ–Ω–∏–¥–∞–Ω –∏–º–∑–æ–ª–∞–Ω–≥–∞–Ω –±—û–ª—Å–∞ –∞–º–∞–ª–∏–π –∫—É—á–≥–∞ —ç–≥–∞ –±—û–ª–∞–¥–∏.")
    add_p("14. –ù–∏–∑–æ–ª–∞—Ä–Ω–∏ —Ö–∞–ª “õ–∏–ª–∏—à", True, "center")
    add_p("14.2. ‚Äú–°–æ—Ç—É–≤—á–∏‚Äù –§—É“õ–∞—Ä–æ–ª–∏–∫ –∏—à–ª–∞—Ä–∏ –±—û–π–∏—á–∞ –°–∏—Ä–¥–∞—Ä—ë —Ç—É–º–∞–Ω–ª–∞—Ä–∞—Ä–æ —Å—É–¥–ª–∞—Ä–∏–≥–∞ –¥–∞—ä–≤–æ –∞—Ä–∏–∑–∞—Å–∏ –±–∏–ª–∞–Ω –º—É—Ä–æ–∂–∞–∞—Ç “õ–∏–ª–∏—à —Ö—É“õ—É“õ–∏–Ω–∏ —û–∑–∏–¥–∞ —Å–∞“õ–ª–∞–± “õ–æ–ª–∞–¥–∏.")
    add_p("15. –Ø–∫—É–Ω–∏–π “õ–æ–∏–¥–∞–ª–∞—Ä", True, "center")
    add_p("15.7. –£—à–±—É –®–∞—Ä—Ç–Ω–æ–º–∞ 2 (–∏–∫–∫–∏) –Ω—É—Å—Ö–∞–¥–∞ —Ç—É–∑–∏–ª–≥–∞–Ω –±—û–ª–∏–±, –∏–∫–∫–∞–ª–∞ –Ω—É—Å—Ö–∞—Å–∏ “≥–∞–º –±–∏—Ä —Ö–∏–ª —é—Ä–∏–¥–∏–∫ –∫—É—á–≥–∞ —ç–≥–∞.")

    # --- 1-ILOVA (JADVAL) ---
    doc.add_page_break()
    add_p(f"‚Ññ {d['nomer']}-—Å–æ–Ω–ª–∏ –®–∞—Ä—Ç–Ω–æ–º–∞—Å–∏–≥–∞\n1-–∏–ª–æ–≤–∞", True, "center")
    add_p("–¢–æ–≤–∞—Ä —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è—Å–∏", True, "center")
    t1 = doc.add_table(rows=2, cols=6, style='Table Grid')
    h = ["‚Ññ", "–ú–∞—Ö—Å—É–ª–æ—Ç –Ω–æ–º–∏", "–£–ª—á–æ–≤ –±–∏—Ä–ª–∏–≥–∏", "–ú–∏–∫–¥–æ—Ä–∏", "–ù–∞—Ä—Ö–∏", "–°—É–º–º–∞—Å–∏"]
    for i, head in enumerate(h): t1.rows[0].cells[i].text = head
    r = t1.rows[1].cells
    val = f"{d['summa']} ({d['summa_soz']}) SO‚ÄôM"
    r[0].text, r[1].text, r[2].text, r[3].text, r[4].text, r[5].text = "1", d['mahsulot'], "–¥–æ–Ω–∞", "1", val, val
    add_p(f"\n–ñ–ê–ú–ò: {val}", True)

    # --- 2-ILOVA (GRAFIK) ---
    doc.add_page_break()
    add_p(f"‚Ññ {d['nomer']}-—Å–æ–Ω–ª–∏ –®–∞—Ä—Ç–Ω–æ–º–∞—Å–∏–≥–∞\n2-–∏–ª–æ–≤–∞", True, "center")
    add_p("–£—à–±—É —à–∞—Ä—Ç–Ω–æ–º–∞–≥–∞ –º—É–≤–æ—Ñ–∏“õ —Ç–æ–≤–∞—Ä–ª–∞—Ä —É—á—É–Ω —Ç—û–ª–æ–≤–ª–∞—Ä –∂–∞–¥–≤–∞–ª–∏", True, "center")
    t2 = doc.add_table(rows=1, cols=3, style='Table Grid')
    h2 = ["–¢—û–ª–æ–≤ —Ç—É—Ä–∏", "–¢—û–ª–æ–≤ –∫–∏—Ä–∏—Ç–∏—à –º—É–¥–¥–∞—Ç–∏", "–¢—û–ª–æ–≤ —Å—É–º–º–∞—Å–∏ (—Å—û–º)"]
    for i, head in enumerate(h2): t2.rows[0].cells[i].text = head
    for i in range(1, int(d['oylar']) + 1):
        row = t2.add_row().cells
        row[0].text, row[1].text, row[2].text = f"{i}-—Ç—û–ª–æ–≤", f"27.{i:02d}.2026 –≥–∞—á–∞", d['oylik']

    # --- REKVIZITLAR ---
    doc.add_page_break()
    add_p("–¢–ê–†–ê–§–õ–ê–†–ù–ò–ù–ì –†–ï–ö–í–ò–ó–ò–¢–õ–ê–†–ò", True, "center")
    sig = doc.add_table(rows=2, cols=2)
    sig.rows[0].cells[0].text, sig.rows[0].cells[1].text = "–•–ê–†–ò–î–û–†", "–°–û–¢–£–í–ß–ò"
    b = sig.rows[1].cells
    b[0].text = f"–§.–ò.–®: {d['ism']}\n–ü–∞—Å–ø–æ—Ä—Ç ‚Ññ: {d['pasport']}\n–ë–µ—Ä–∏–ª–≥–∞–Ω: {d['pas_sana']} {d['pas_joy']}\n–ú–∞–Ω–∑–∏–ª: {d['manzil']}\n–¢–µ–ª: {d['tel']}\n\n–ò–º–∑–æ: ___________"
    b[1].text = "OOO \"NEW DREAMS STAR\"\n–ò–ù–ù: 306547414\n“≤/—Ä: 20208000305108101001\n–ë–∞–Ω–∫: Hamkorbank –ê–¢\n–î–∏—Ä–µ–∫—Ç–æ—Ä: –ù—É—Ä–±–µ–∫–æ–≤ –£.–Æ.\n\n–ò–º–∑–æ: ___________"

    # --- 7-SAHIFA: DALOLATNOMA ---
    doc.add_page_break()
    add_p("“ö–∞–±—É–ª “õ–∏–ª–∏—à ‚Äì —Ç–æ–ø—à–∏—Ä–∏—à –¥–∞–ª–æ–ª–∞—Ç–Ω–æ–º–∞—Å–∏", True, "center", 14)
    add_p("–é–∑ “õ—û–ª–∏ –±–∏–ª–∞–Ω —ë–∑–∏–ª—Å–∏–Ω: –ë–∞—Ä—á–∞ —Ç–æ–≤–∞—Ä–ª–∞—Ä —Å–∏—Ñ–∞—Ç –≤–∞ —è—Ä–æ“õ–ª–∏–ª–∏–∫ –º—É–¥–¥–∞—Ç–∏–≥–∞ –º—É–≤–æ—Ñ–∏“õ–¥–∏—Ä, “≥–µ—á “õ–∞–Ω–¥–∞–π –∫–∞–º—á–∏–ª–∏–∫ –≤–∞ –±—É–∑–∏–ª–∏—à–ª–∞—Ä –º–∞–≤–∂—É–¥ —ç–º–∞—Å. –≠—ä—Ç–∏—Ä–æ–∑–∏–º –π—û“õ.")
    add_p("\n\n–¢–æ–≤–∞—Ä–ª–∞—Ä–Ω–∏ “õ–∞–±—É–ª “õ–∏–ª–¥–∏–º. ______________________ (–∏–º–∑–æ)")

    buf = io.BytesIO()
    doc.save(buf)
    buf.seek(0)
    return buf

# --- INTERFEYS ---
st.header("üìÑ Rasmiy 7 Sahifali Shartnoma Generatori")
st.info("Iltimos, faqat qizil rangli (o'zgaruvchan) ma'lumotlarni kiriting. Qolgan barcha bandlar avtomatik ravishda asil nusxadagidek shakllanadi.")

with st.form("contract_input"):
    col1, col2 = st.columns(2)
    with col1:
        nomer = st.text_input("Shartnoma ‚Ññ:", "3080")
        sana = st.text_input("Sana:", "27.12.2025")
        ism = st.text_input("–•–∞—Ä–∏–¥–æ—Ä –§.–ò.–®:", "URINBAYEV SHOHJAHON SHAROF O‚ÄôG‚ÄôLI")
        pas = st.text_input("Pasport ‚Ññ:", "AD6259891")
        p_sana = st.text_input("Pasport sana:", "23.02.2024Y")
    with col2:
        p_joy = st.text_input("Bergan tashkilot:", "JIZZAX VILOYATI JIZZAX TUMANI IIV")
        manzil = st.text_area("Yashash manzili:", "JIZZAX VILOYATI TOSHLOQ QFY 17-UY")
        tel = st.text_input("Telefonlar:", "90 487 97 77 / 33 016 05 75")
        mahsulot = st.text_input("Mahsulot nomi:", "IPHONE 13 PRO")
        summa = st.text_input("Jami summa (raqam):", "5 436 000")
        summa_soz = st.text_input("Jami summa (so'z):", "BESH MILLION TO‚ÄôRT YUZ O‚ÄôTIZ OLTI MING")
        oylar = st.number_input("Muddat (oy):", 1, 24, 6)
        oylik = st.text_input("Oylik to'lov:", "906 000")
    
    submitted = st.form_submit_button("Shartnomani tayyorlash")

if submitted:
    data = {'nomer':nomer,'sana':sana,'ism':ism,'pasport':pas,'pas_sana':p_sana,'pas_joy':p_joy,'manzil':manzil,'tel':tel,'mahsulot':mahsulot,'summa':summa,'summa_soz':summa_soz,'oylar':oylar,'oylik':oylik}
    file = create_official_docx(data)
    st.success("‚úÖ Shartnoma muvaffaqiyatli tayyorlandi!")
    st.download_button("üì• 7 SAHIFALI WORD FAYLNI YUKLAB OLISH", file, f"Shartnoma_{nomer}.docx")
